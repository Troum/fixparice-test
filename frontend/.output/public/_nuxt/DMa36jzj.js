import{bj as f,g,bk as w,bl as a,bm as h}from"./DwR0AEf0.js";import{u as D}from"./De67kLFm.js";const k=f(async(n,p)=>{let e,o;if(!n.path.startsWith("/demo"))return;const{token:c}=g(),{autoDemoLogin:m,isDemoUser:l}=D(),{show:d,hide:u,setMessage:i,setProgress:s}=w();if(!(l.value&&c.value?.access_token))try{d("Подготовка демо режима",!0),s(20),[e,o]=a(()=>new Promise(r=>setTimeout(r,300))),await e,o(),i("Авторизация под demo пользователем"),s(50);const t=([e,o]=a(()=>m()),e=await e,o(),e);if(s(80),!t)throw new Error("Demo login failed");i("Демо готово!"),s(100),[e,o]=a(()=>new Promise(r=>setTimeout(r,500))),await e,o(),u(),console.log("Demo user auto-login successful")}catch(t){throw u(),console.error("Demo auto-login failed:",t),h({statusCode:500,statusMessage:"Демо недоступен. Попробуйте позже или войдите вручную."})}});export{k as default};
