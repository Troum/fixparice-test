import{e as U,l as A,f as L,m as R,n as m,p as D,y as E,c as k,a as s,q as y,s as w,b as r,w as l,i as e,v as I,j as J,o as c,d as g,h as M,t as T,u as j}from"./DwR0AEf0.js";import{_ as q}from"./CT_WQt0m.js";import{_ as z}from"./COr5thys.js";import{J as F}from"./BD53Fd1c.js";import"./DaMzFuD0.js";import"./Cz8f_uTG.js";import"./BiHkM03E.js";const H={class:"min-h-screen p-4"},O={class:"max-w-2xl mx-auto"},G={class:"mb-6"},K={class:"text-center py-8"},P={class:"text-red-500 mb-4"},Q={class:"space-x-2"},W={key:2},X={class:"flex items-center gap-2 text-sm text-gray-600"},rt=U({__name:"edit",setup(Y){const C=A(),d=L(),p=R(),{getVacancy:$,updateVacancy:V}=I(),i=C.params.id,a=m(),_=m(!1),f=m(!0),v=m(null),b=async()=>{f.value=!0,v.value=null;try{a.value=await $(i)}catch(u){v.value=u,p.add({title:"Ошибка",description:"Не удалось загрузить данные вакансии",color:"error"})}finally{f.value=!1}},B=async u=>{_.value=!0;try{await V(i,u),p.add({title:"Успех!",description:"Вакансия успешно обновлена",color:"success"}),d.push(`/jobs/${i}`)}catch(t){console.error("Ошибка обновления вакансии:",t);let o="Не удалось обновить вакансию";if(t.data&&t.data.errors){const n=t.data.errors;Array.isArray(n)?o=n.join(", "):typeof n=="object"&&(o=Object.values(n).flat().join(", "))}p.add({title:"Ошибка обновления",description:o,color:"error"})}finally{_.value=!1}},N=()=>{d.push(`/jobs/${i}`)};return D(()=>{b()}),E(()=>{a.value?.title?j({title:`Редактирование: ${a.value.title}`}):j({title:"Редактирование вакансии"})}),(u,t)=>{const o=J,n=q,x=M,h=z;return c(),k("div",H,[s("div",O,[s("div",G,[r(o,{icon:"i-lucide-arrow-left",variant:"ghost",onClick:t[0]||(t[0]=S=>e(d).push(`/jobs/${e(i)}`))},{default:l(()=>[...t[2]||(t[2]=[g(" Назад к вакансии ",-1)])]),_:1})]),e(f)?(c(),y(n,{key:0,message:"Загрузка данных вакансии",size:"lg"})):e(v)?(c(),y(h,{key:1,class:"border-red-200"},{default:l(()=>[s("div",K,[s("div",P,[r(x,{name:"i-lucide-alert-circle",class:"w-12 h-12 mx-auto"})]),t[5]||(t[5]=s("h3",{class:"text-lg font-semibold text-red-700 mb-2"},"Ошибка загрузки",-1)),t[6]||(t[6]=s("p",{class:"text-gray-600 mb-4"},"Не удалось загрузить данные вакансии для редактирования",-1)),s("div",Q,[r(o,{onClick:b,color:"red",variant:"outline"},{default:l(()=>[...t[3]||(t[3]=[g(" Попробовать снова ",-1)])]),_:1}),r(o,{onClick:t[1]||(t[1]=S=>e(d).push("/jobs")),variant:"ghost"},{default:l(()=>[...t[4]||(t[4]=[g(" К списку вакансий ",-1)])]),_:1})])])]),_:1})):e(a)?(c(),k("div",W,[r(F,{"initial-data":e(a),loading:e(_),"is-edit":"",onSubmit:B,onCancel:N},null,8,["initial-data","loading"]),e(a).updated_at?(c(),y(h,{key:0,class:"mt-6 border-gray-200 bg-gray-50"},{default:l(()=>[s("div",X,[r(x,{name:"i-lucide-clock",class:"w-4 h-4"}),s("span",null," Последнее обновление: "+T(new Date(e(a).updated_at*1e3).toLocaleString("ru-RU")),1)])]),_:1})):w("",!0)])):w("",!0)])])}}});export{rt as default};
